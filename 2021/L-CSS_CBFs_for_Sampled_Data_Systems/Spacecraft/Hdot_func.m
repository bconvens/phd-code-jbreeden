function out = Hdot_func(x, u)
global constants
s = constants.s;
mu = constants.mu;
r = x(1:3);
w = x(4:6);
out = s(3)*(r(2)*w(1)-r(1)*w(2))+s(2)*(-r(3)*w(1)+r(1)*w(3))+s(1)*(r(3)*w(2) ...
    -r(2)*w(3))+(1/mu)*abs(s(3)*r(2)*w(1)-s(2)*r(3)*w(1)-s(3)*r(1)*w(2) ...
    +s(1)*r(3)*w(2)+s(2)*r(1)*w(3)-s(1)*r(2)*w(3))*(r(3)*(-s(2)*u(1)+s(1)*u(2) ...
    -s(3)*(w(1)^2+w(2)^2)+(s(1)*w(1)+s(2)*w(2))*w(3))+r(2)*(s(3)*u(1)-s(1)*u(3) ...
    -s(2)*w(1)^2+s(1)*w(1)*w(2)+s(3)*w(2)*w(3)-s(2)*w(3)^2)+r(1)*(-s(3)*u(2) ...
    +s(2)*u(3)+w(1)*(s(2)*w(2)+s(3)*w(3))-s(1)*(w(2)^2+w(3)^2)));
end