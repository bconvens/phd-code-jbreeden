function out = GradLgH_func(x)
global constants
sigma = constants.sigma;
r = x(1:2); phi = x(3);
psi = 0; % remaining from previous versions of this file
out = [[(-4*r(1)*(psi^2*sigma-sigma*wrap_angle(atan2(r(2),r(1))-phi)^2+r(1)^2+r(2)^2)*(-cos(phi)*(r(1)^3+sigma*wrap_angle(atan2(r(2),r(1))-phi)*r(2)+r(1)*r(2)^2)-(sigma*(-atan2(r(2),r(1))+phi)*r(1)+r(1)^2*r(2)+r(2)^3)*sin(phi))-2*(r(1)^3+sigma*wrap_angle(atan2(r(2),r(1))-phi)*r(2)+r(1)*r(2)^2)*(-cos(phi)*(r(1)^3+sigma*wrap_angle(atan2(r(2),r(1))-phi)*r(2)+r(1)*r(2)^2)-(sigma*(-atan2(r(2),r(1))+phi)*r(1)+r(1)^2*r(2)+r(2)^3)*sin(phi))+2*(psi^2*sigma-sigma*wrap_angle(atan2(r(2),r(1))-phi)^2+r(1)^2+r(2)^2)*(-cos(phi)*(3*r(1)^4-(sigma-4*r(1)^2)*r(2)^2+r(2)^4)-(sigma*r(1)*r(2)-sigma*wrap_angle(atan2(r(2),r(1))-phi)*(r(1)^2+r(2)^2)+2*r(1)*r(2)*(r(1)^2+r(2)^2))*sin(phi)))/(2*(r(1)^2+r(2)^2)^2*(psi^2*sigma-sigma*wrap_angle(atan2(r(2),r(1))-phi)^2+r(1)^2+r(2)^2)^(3/2)),(-4*r(2)*(psi^2*sigma-sigma*wrap_angle(atan2(r(2),r(1))-phi)^2+r(1)^2+r(2)^2)*(-cos(phi)*(r(1)^3+sigma*wrap_angle(atan2(r(2),r(1))-phi)*r(2)+r(1)*r(2)^2)-(sigma*(-atan2(r(2),r(1))+phi)*r(1)+r(1)^2*r(2)+r(2)^3)*sin(phi))-2*(sigma*(-atan2(r(2),r(1))+phi)*r(1)+r(1)^2*r(2)*+r(2)^3)*(-cos(phi)*(r(1)^3+sigma*wrap_angle(atan2(r(2),r(1))-phi)*r(2)+r(1)*r(2)^2)-(sigma*(-atan2(r(2),r(1))+phi)*r(1)+r(1)^2*r(2)+r(2)^3)*sin(phi))+2*(psi^2*sigma-sigma*wrap_angle(atan2(r(2),r(1))-phi)^2+r(1)^2+r(2)^2)*(-cos(phi)*(sigma*r(1)*r(2)+sigma*wrap_angle(atan2(r(2),r(1))-phi)*(r(1)^2+r(2)^2)+2*r(1)*r(2)*(r(1)^2+r(2)^2))+(-r(1)^4-3*r(2)^4+r(1)^2*(sigma-4*r(2)^2))*sin(phi)))/(2*(r(1)^2+r(2)^2)^2*(psi^2*sigma-sigma*wrap_angle(atan2(r(2),r(1))-phi)^2+r(1)^2+r(2)^2)^(3/2)),((psi^2*sigma-sigma*wrap_angle(atan2(r(2),r(1))-phi)^2+r(1)^2+r(2)^2)*(sigma*cos(phi)*r(2)-cos(phi)*(sigma*(-atan2(r(2),r(1))+phi)*r(1)+r(1)^2*r(2)+r(2)^3)-sigma*r(1)*sin(phi)+(r(1)^3+sigma*wrap_angle(atan2(r(2),r(1))-phi)*r(2)+r(1)*r(2)^2)*sin(phi))-sigma*wrap_angle(atan2(r(2),r(1))-phi)*(-cos(phi)*(r(1)^3+sigma*wrap_angle(atan2(r(2),r(1))-phi)*r(2)+r(1)*r(2)^2)-(sigma*(-atan2(r(2),r(1))+phi)*r(1)+r(1)^2*r(2)+r(2)^3)*sin(phi)))/((r(1)^2+r(2)^2)*(psi^2*sigma-sigma*wrap_angle(atan2(r(2),r(1))-phi)^2+r(1)^2+r(2)^2)^(3/2))];,[(sigma*(psi^2*sigma*r(2)+(wrap_angle(atan2(r(2),r(1))-phi)*r(1)+r(2))*(r(1)^2*+r(2)^2)))/((r(1)^2+r(2)^2)*(psi^2*sigma-sigma*wrap_angle(atan2(r(2),r(1))-phi)^2+r(1)^2+r(2)^2)^(3/2)),-((sigma*(r(1)^3+(-atan2(r(2),r(1))+phi)*r(1)^2*r(2)+(-atan2(r(2),r(1))+phi)*r(2)^3+r(1)*(psi^2*sigma+r(2)^2)))/((r(1)^2+r(2)^2)*(psi^2*sigma-sigma*wrap_angle(atan2(r(2),r(1))-phi)^2+r(1)^2+r(2)^2)^(3/2))),(sigma*(psi^2*sigma+r(1)^2+r(2)^2))/(psi^2*sigma-sigma*wrap_angle(atan2(r(2),r(1))-phi)^2+r(1)^2+r(2)^2)^(3/2)]];
end