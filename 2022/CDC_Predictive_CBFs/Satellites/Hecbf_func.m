function [H, dHdt, dHdu] = Hecbf_func(t,x)
f = [zeros(3), eye(3); zeros(3), zeros(3)];
g = [zeros(3); eye(3)];
h = h_func(t,x);
[dhdt, dhdx] = dh_func(t,x);
hdot = dhdt + dhdx*f*x;
c = 0.01;
H = hdot + c*h;

[dhdot_dt, dhdot_dx] = dhdot_func(t,x);

dHdt = c*hdot + dhdot_dt + dhdot_dx*two_body(x,[0;0;0]);
dHdu = dhdot_dx*g;
end

function [dhdt, dhdx] = dh_func(t,x)
global debris_ke
a = debris_ke.a;
e = debris_ke.e;
i = debris_ke.i;
O = debris_ke.O;
o = debris_ke.o;
nu0 = debris_ke.nu0;
mu = 398600;
n = sqrt(mu/a^3);
x1 = x(1); x2 = x(2); x3 = x(3);
dhdt = (2*(x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) - 2*(x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2))/(2*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2));
dhdx = [ -(2*x1 + (2*a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))/(2*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)), -(2*x2 + (2*a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))/(2*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)), -(2*x3 + (2*a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))/(2*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)), 0, 0, 0];
end

function [dhdot_dt, dhdot_dx] = dhdot_func(t,x)
global debris_ke
a = debris_ke.a;
e = debris_ke.e;
i = debris_ke.i;
O = debris_ke.O;
o = debris_ke.o;
nu0 = debris_ke.nu0;
mu = 398600;
n = sqrt(mu/a^3);
x1 = x(1); x2 = x(2); x3 = x(3); x4 = x(4); x5 = x(5); x6 = x(6);
dhdot_dt = - (- 2*(x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n^2*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n^2*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*e*n^2*sin(nu0 + n*t)^2*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (2*a*e^2*n^2*sin(nu0 + n*t)^3*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^3 - (a*e*n^2*cos(nu0 + n*t)^2*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (3*a*e*n^2*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (2*a*e^2*n^2*cos(nu0 + n*t)*sin(nu0 + n*t)^2*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^3) - 2*(x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n^2*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n^2*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*e*n^2*sin(nu0 + n*t)^2*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (2*a*e^2*n^2*sin(nu0 + n*t)^3*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^3 - (a*e*n^2*cos(nu0 + n*t)^2*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (3*a*e*n^2*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (2*a*e^2*n^2*cos(nu0 + n*t)*sin(nu0 + n*t)^2*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^3) + 2*((a*n*cos(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)^2 + 2*((a*n*cos(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)^2 + 2*((a*n*cos(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)^2 + 2*(x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*e*n^2*cos(nu0 + n*t)^2*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*n^2*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n^2*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*e*n^2*sin(nu0 + n*t)^2*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (2*a*e^2*n^2*sin(nu0 + n*t)^3*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^3 + (2*a*e^2*n^2*cos(nu0 + n*t)*sin(nu0 + n*t)^2*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^3 + (3*a*e*n^2*cos(nu0 + n*t)*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2))/(2*((x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x1 + (a*cos(nu0 + n*t)*(e^2 - 1)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(e^2 - 1)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)) + (- 2*(x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2))^2/(4*((x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x1 + (a*cos(nu0 + n*t)*(e^2 - 1)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(e^2 - 1)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) + (x4*((2*a*n*cos(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*n*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*e*n*sin(nu0 + n*t)^2*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (2*a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2))/(2*((x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x1 + (a*cos(nu0 + n*t)*(e^2 - 1)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(e^2 - 1)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)) + (x5*((2*a*n*cos(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*n*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*e*n*sin(nu0 + n*t)^2*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (2*a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2))/(2*((x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x1 + (a*cos(nu0 + n*t)*(e^2 - 1)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(e^2 - 1)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)) - (x6*((2*a*n*cos(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*n*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*e*n*sin(nu0 + n*t)^2*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (2*a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2))/(2*((x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x1 + (a*cos(nu0 + n*t)*(e^2 - 1)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(e^2 - 1)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)) - (x4*(2*x1 + (2*a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(- 2*(x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)))/(4*((x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x1 + (a*cos(nu0 + n*t)*(e^2 - 1)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(e^2 - 1)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) - (x5*(2*x2 + (2*a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(- 2*(x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)))/(4*((x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x1 + (a*cos(nu0 + n*t)*(e^2 - 1)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(e^2 - 1)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) - (x6*(2*x3 + (2*a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(- 2*(x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)))/(4*((x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x1 + (a*cos(nu0 + n*t)*(e^2 - 1)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(e^2 - 1)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o)))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(e^2 - 1)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o)))/(e*cos(nu0 + n*t) + 1))^2)^(3/2));
dhdot_dx = [ ((2*a*n*cos(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*n*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*e*n*sin(nu0 + n*t)^2*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (2*a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)/(2*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)) - x4/((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2) - ((2*x1 + (2*a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(2*(x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) - 2*(x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)))/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) + (x4*(2*x1 + (2*a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) + (x5*(2*x1 + (2*a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(2*x2 + (2*a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)))/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) + (x6*(2*x1 + (2*a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(2*x3 + (2*a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)))/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)), ((2*a*n*cos(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*n*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*e*n*sin(nu0 + n*t)^2*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (2*a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)/(2*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)) - x5/((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2) - ((2*x2 + (2*a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(2*(x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) - 2*(x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)))/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) + (x5*(2*x2 + (2*a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) + (x4*(2*x1 + (2*a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(2*x2 + (2*a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)))/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) + (x6*(2*x2 + (2*a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(2*x3 + (2*a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)))/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)), (x6*(2*x3 + (2*a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) - x6/((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2) - ((2*x3 + (2*a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(2*(x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) - 2*(x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*n*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2) + 2*(x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*((a*n*cos(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*n*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*e*n*sin(nu0 + n*t)^2*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 - (a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)))/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) - ((2*a*n*cos(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*n*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*e*n*sin(nu0 + n*t)^2*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2 + (2*a*e*n*cos(nu0 + n*t)*sin(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)^2)/(2*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)) + (x4*(2*x1 + (2*a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(2*x3 + (2*a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)))/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)) + (x5*(2*x2 + (2*a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))*(2*x3 + (2*a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1)))/(4*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(3/2)), -(2*x1 + (2*a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))/(2*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)), -(2*x2 + (2*a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (2*a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))/(2*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2)), -(2*x3 + (2*a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (2*a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))/(2*((x1 + (a*cos(nu0 + n*t)*(cos(O)*cos(o) - sin(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(cos(O)*sin(o) + sin(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x2 + (a*cos(nu0 + n*t)*(sin(O)*cos(o) + cos(O)*cos(i)*sin(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) - (a*sin(nu0 + n*t)*(sin(O)*sin(o) - cos(O)*cos(i)*cos(o))*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2 + (x3 + (a*cos(nu0 + n*t)*sin(i)*sin(o)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1) + (a*sin(nu0 + n*t)*cos(o)*sin(i)*(e^2 - 1))/(e*cos(nu0 + n*t) + 1))^2)^(1/2))];
end

% syms t x1 x2 x3 x4 x5 x6
% x = [x1; x2; x3; x4; x5; x6];
% syms a e i O o nu0 mu n
% nu = nu0 + n*t
% y = KeplerToCartesian(a,e,i,O,o,nu,mu)
% h = 1 - sqrt(sum(([x1;x2;x3] - y(1:3)).^2))
% dhdt = diff(h, t)
% dhdx = jacobian(h, x)
% hdot = dhdt + dhdx*[zeros(3), eye(3); zeros(3), zeros(3)]*x;
% dhdot_dt = diff(hdot, t)
% dhdot_dx = jacobian(hdot, x)