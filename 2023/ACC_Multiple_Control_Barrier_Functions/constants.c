#include "verify.h"

const double mu = 0.004; // this is called beta_i in the paper

#ifdef _RUN_CASE_1_
double q_sparsity = 0.1;
double w_sparsity = 0.0024;
#else
double q_sparsity = 0.01;
double w_sparsity = 0.0012; // corresponds to Nw=51
#endif

const int Nwmin = 4;
const int Nwmax = 60;

#ifdef _RUN_CASE_3_
const double q_neighbor_tol = 0.5;
#else
const double q_neighbor_tol = 0.05;
#endif

double rb[3] = {0.707106781187, 0.707106781187, 0};
const double w_max = 0.03;
const double u_max = 0.01;
const double H_zero_tol = 1e-4;
const double eps_tol = 1e-12;
long MAX_TRACKED_POINTS;
int NM;

double M_start[NM0][4][4] = {{{ 0.064319171500008,   0.707106781186548,                   0,                   0},
                           { 0.707106781186548,  -1.349894390873087,                   0,                   0},
                           {                 0,                   0,  -1.349894390873087,  -0.707106781186548},
                           {                 0,                   0,  -0.707106781186548,   0.064319171500008}},
                          {{-1.349894390873087,   0.707106781186548,                   0,                   0},
                           { 0.707106781186548,   0.064319171500008,                   0,                   0},
                           {                 0,                   0,  -1.349894390873087,   0.707106781186548},
                           {                 0,                   0,   0.707106781186548,   0.064319171500008}}};

// double M_start[NM0][4][4] = {{{ 0.064319171500008,   0.707106781186548,                   0,                   0},
//                               { 0.707106781186548,  -1.349894390873087,                   0,                   0},
//                               {                 0,                   0,  -1.349894390873087,  -0.707106781186548},
//                               {                 0,                   0,  -0.707106781186548,   0.064319171500008}},
//                              {{-1.349894390873087,   0.707106781186548,                   0,                   0},
//                               { 0.707106781186548,   0.064319171500008,                   0,                   0},
//                               {                 0,                   0,  -1.349894390873087,   0.707106781186548},
//                               {                 0,                   0,   0.707106781186548,   0.064319171500008}},
//                              {{-0.986838974546254,   0.887029394552683,  -0.326360185109183,  -0.326360185109183},
//                               {  0.887029394552683,  -1.011942679491938,  -0.326360185109183,   0.326360185109183},
//                               { -0.326360185109183,  -0.326360185109183,  -1.886420221571779,  -0.012551852472842},
//                               { -0.326360185109183,   0.326360185109183,  -0.012551852472842,  -0.112361432466412}},
//                              {{-1.011942679491938,   0.887029394552683,   0.326360185109183,   0.326360185109183},
//                               { 0.887029394552683,  -0.986838974546254,   0.326360185109183,  -0.326360185109183},
//                               { 0.326360185109183,   0.326360185109183,  -1.886420221571779,   0.012551852472842},
//                               { 0.326360185109183,  -0.326360185109183,   0.012551852472842,  -0.112361432466412}}};

double (*M_all)[4][4];